<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Exploring Mexican Culinary Heritage – Interactive Activity</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand: #6b8d94;
      --brand-light: #7ba1a5;
      --accent: #ef7c8e;
      --accent-light: #ffe8e3;
      --success: #ef7c8e;
      --success-light: #ffe8e3;
      --warning: #e89a8a;
      --ink: #373f45;
      --text-muted: #64748b;
      --text-light: #94a3b8;
      --bg-primary: #ffffff;
      --bg-secondary: #f8ebec;
      --bg-tertiary: #f1f5f9;
      --border-light: #e2e8f0;
      --border-medium: #cbd5e1;
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
      --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --transition-fast: 0.15s ease-out;
      --transition-medium: 0.25s ease-out;
      --transition-slow: 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0; 
      padding: 0;
      font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 16px; 
      line-height: 1.6;
      color: var(--ink);
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      scroll-behavior: smooth;
    }

    h1, h2, h3 {
      font-family: 'Crimson Text', serif;
      font-weight: 600;
      line-height: 1.2;
      margin: 0;
    }

    h1 { font-size: 2.5rem; color: var(--brand); }
    h2 { font-size: 1.875rem; color: var(--ink); margin-bottom: 1rem; }
    h3 { font-size: 1.5rem; color: var(--brand); margin-bottom: 0.75rem; }

    p { margin: 0 0 1rem; }
    
    .text-sm { font-size: 0.875rem; color: var(--text-muted); }
    .text-xs { font-size: 0.75rem; color: var(--text-light); }

    a { 
      color: var(--accent); 
      text-decoration: none;
      transition: color var(--transition-fast);
    }
    a:hover { color: var(--brand); }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }

    .section {
      margin-bottom: 3rem;
    }

    .card {
      background: var(--bg-primary);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-lg);
      padding: 2rem;
      box-shadow: var(--shadow-md);
      transition: box-shadow var(--transition-medium);
    }

    .card:hover {
      box-shadow: var(--shadow-lg);
    }

    .header {
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
      border: 2px solid var(--border-light);
      border-left: 6px solid var(--brand);
      border-radius: var(--radius-lg);
      padding: 2.5rem;
      box-shadow: var(--shadow-xl);
      margin-bottom: 3rem;
      text-align: center;
    }

    .header h1 {
      margin-bottom: 1rem;
    }

    .header-links {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1.5rem;
      flex-wrap: wrap;
    }

    .header-link {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.25rem;
      background: var(--bg-primary);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-md);
      font-weight: 500;
      transition: all var(--transition-medium);
      box-shadow: var(--shadow-sm);
    }

    .header-link:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
      border-color: var(--brand);
    }

    .flip-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
      margin-top: 2rem;
      max-width: 100%;
    }

    @media (max-width: 1024px) {
      .flip-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1.25rem;
      }
    }

    @media (max-width: 768px) {
      .flip-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
    }

    .flip-card {
      perspective: 1200px;
      height: 500px;
      cursor: pointer;
      transition: transform var(--transition-medium);
      width: 100%;
    }

    .flip-card:hover {
      transform: scale(1.02);
    }

    .flip-card:focus {
      outline: 3px solid var(--brand);
      outline-offset: 4px;
    }

    .flip-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .flip-card.is-flipped .flip-inner {
      transform: rotateY(180deg);
    }

    .flip-front, .flip-back {
      position: absolute;
      inset: 0;
      backface-visibility: hidden;
      border-radius: var(--radius-lg);
      border: 2px solid var(--border-light);
      background: var(--bg-primary);
      box-shadow: var(--shadow-lg);
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      overflow-y: auto;
      font-size: 0.9rem;
    }

    .flip-front {
      border-top: 6px solid var(--brand);
    }

    .flip-back {
      border-top: 6px solid var(--accent);
      transform: rotateY(180deg);
    }

    .flip-badge {
      align-self: flex-start;
      background: linear-gradient(135deg, var(--brand) 0%, var(--brand-light) 100%);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 999px;
      font-size: 0.875rem;
      font-weight: 600;
      box-shadow: var(--shadow-md);
    }

    .translation-btn {
      align-self: flex-start;
      background: var(--bg-secondary);
      border: 1px solid var(--border-medium);
      padding: 0.5rem 1rem;
      border-radius: var(--radius-md);
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: all var(--transition-medium);
      box-shadow: var(--shadow-sm);
    }

    .translation-btn:hover {
      background: var(--brand);
      color: white;
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .translation-btn:active {
      transform: translateY(0);
    }

    .translation-btn.active {
      background: var(--brand);
      color: white;
    }

    .quote {
      font-family: 'Crimson Text', serif;
      font-size: 0.95rem;
      line-height: 1.5;
      font-style: italic;
      color: var(--ink);
      background: linear-gradient(135deg, #e0e7ff 0%, #ddd6fe 100%);
      padding: 1rem;
      border-radius: var(--radius-md);
      border: 2px solid var(--brand);
      margin: 0.5rem 0;
    }

    .attribution {
      font-size: 0.75rem;
      color: var(--text-muted);
      padding: 0.75rem;
      background: var(--bg-secondary);
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-light);
      margin-top: auto;
    }

    .translation {
      display: none;
      font-style: italic;
      color: var(--text-muted);
      background: var(--success-light);
      padding: 1rem;
      border-radius: var(--radius-sm);
      border-left: 4px solid var(--success);
      font-size: 0.85rem;
      margin: 0.5rem 0;
      animation: fadeIn var(--transition-medium);
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .flip-hint {
      margin-top: auto;
      text-align: center;
      color: var(--text-light);
      font-size: 0.8rem;
      padding: 0.75rem;
      background: var(--bg-tertiary);
      border-radius: var(--radius-sm);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    .research-topic h3 {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
      font-size: 1.2rem;
    }

    .research-topic ul {
      margin: 0 0 0.75rem 0;
      padding-left: 1.25rem;
    }

    .research-topic li {
      margin-bottom: 0.5rem;
      color: var(--text-muted);
      font-size: 0.85rem;
      line-height: 1.4;
    }

    .research-links {
      background: var(--bg-tertiary);
      padding: 0.75rem;
      border-radius: var(--radius-md);
      max-height: 180px;
      overflow-y: auto;
      flex: 1;
    }

    .research-links strong {
      display: block;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }

    .research-links ul {
      margin: 0;
      padding: 0;
      list-style: none;
    }

    .research-links li {
      margin-bottom: 0.5rem;
    }

    .research-links a {
      display: block;
      padding: 0.5rem;
      background: var(--bg-primary);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-sm);
      transition: all var(--transition-medium);
      box-shadow: var(--shadow-sm);
      font-size: 0.8rem;
    }

    .research-links a:hover {
      background: var(--brand);
      color: white;
      transform: translateX(4px);
      box-shadow: var(--shadow-md);
    }

    .notes-textarea {
      width: 100%;
      min-height: 200px;
      border: 2px solid var(--border-light);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      font-family: inherit;
      font-size: 1rem;
      line-height: 1.6;
      resize: vertical;
      transition: border-color var(--transition-medium);
      background: var(--success-light);
    }

    .notes-textarea:focus {
      outline: none;
      border-color: var(--success);
      background: var(--bg-primary);
      box-shadow: 0 0 0 3px rgb(239 124 142 / 0.1);
    }

    .notes-status {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 0.75rem;
      padding: 0.5rem 1rem;
      background: var(--success);
      color: white;
      border-radius: var(--radius-sm);
      font-size: 0.875rem;
      font-weight: 500;
      opacity: 0;
      transition: opacity var(--transition-medium);
    }

    .notes-status.show {
      opacity: 1;
    }

    .cultural-note {
      background: linear-gradient(135deg, #ffe8e3 0%, #f1f5f9 100%);
      border-left: 6px solid var(--success);
      border-radius: var(--radius-lg);
      padding: 2rem;
      margin: 2rem 0;
      box-shadow: var(--shadow-lg);
    }

    .cultural-note h3 {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .references-toggle {
      background: var(--success-light);
      border: 2px solid var(--success);
      color: var(--ink);
      padding: 0.75rem 1.25rem;
      border-radius: var(--radius-md);
      cursor: pointer;
      font-weight: 500;
      margin-top: 1rem;
      transition: all var(--transition-medium);
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .references-toggle:hover {
      background: var(--success);
      color: white;
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .references-content {
      display: none;
      margin-top: 1rem;
      padding: 1.5rem;
      background: rgba(255, 255, 255, 0.8);
      border-radius: var(--radius-sm);
      border: 1px solid var(--success);
      animation: fadeIn var(--transition-medium);
    }

    .references-content.show {
      display: block;
    }

    .toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      align-items: center;
      margin-bottom: 1.5rem;
      padding: 1.5rem;
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      border: 1px solid var(--border-light);
    }

    .toolbar-group {
      display: flex;
      gap: 0.75rem;
      align-items: center;
      padding: 0.75rem 1rem;
      background: var(--bg-primary);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-sm);
    }

    .toolbar-group label {
      font-weight: 500;
      color: var(--text-muted);
      font-size: 0.875rem;
    }

    .btn {
      appearance: none;
      border: 1px solid var(--border-medium);
      background: var(--bg-primary);
      padding: 0.75rem 1.25rem;
      border-radius: var(--radius-md);
      cursor: pointer;
      font-weight: 500;
      transition: all var(--transition-medium);
      box-shadow: var(--shadow-sm);
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn:hover {
      background: var(--bg-tertiary);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    .btn.active {
      background: var(--brand);
      color: white;
      border-color: var(--brand);
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--brand) 0%, var(--accent) 100%);
      color: white;
      border: none;
      font-weight: 600;
      box-shadow: var(--shadow-md);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .canvas-wrapper {
      border-radius: var(--radius-lg);
      overflow: hidden;
      background: var(--bg-primary);
      box-shadow: var(--shadow-lg);
      border: 2px solid var(--border-light);
    }

    #posterCanvas {
      width: 100%;
      height: auto;
      display: block;
      cursor: crosshair;
    }

    .step-indicator {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 2rem;
      height: 2rem;
      background: var(--brand);
      color: white;
      border-radius: 50%;
      font-weight: 600;
      margin-right: 1rem;
    }

    .checklist {
      list-style: none;
      padding: 0;
      margin: 1.5rem 0;
    }

    .checklist li {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      margin-bottom: 1rem;
      padding: 1rem;
      background: var(--success-light);
      border-radius: var(--radius-md);
      border-left: 4px solid var(--success);
    }

    .checklist li::before {
      content: "✔";
      background: var(--success);
      color: white;
      width: 1.5rem;
      height: 1.5rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.875rem;
      flex-shrink: 0;
    }

    .footer {
      background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
      color: #cbd5e1;
      padding: 2.5rem;
      text-align: center;
      margin-top: 4rem;
      border-radius: var(--radius-lg);
      border: 2px solid #334155;
    }

    @media (max-width: 768px) {
      .container {
        padding: 1rem;
      }
      
      .header {
        padding: 2rem 1.5rem;
        text-align: center;
      }
      
      .header h1 {
        font-size: 2rem;
      }
      
      .flip-card {
        height: 450px;
      }
      
      .toolbar {
        padding: 1rem;
      }
      
      .toolbar-group {
        flex-wrap: wrap;
      }
    }

    .loading {
      opacity: 0.7;
      pointer-events: none;
    }

    .flip-card.transitioning {
      pointer-events: none;
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    button:focus,
    input:focus,
    textarea:focus,
    .flip-card:focus {
      outline: 2px solid var(--brand);
      outline-offset: 2px;
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- Enhanced Header -->
    <header class="header">
      <h1>🌽 Exploring Mexican Culinary Heritage</h1>
      <p>Instructions in English. Spanish quotes remain in Spanish with translations available.</p>
      <div class="header-links">
        <a href="https://www.spanish-learning-edge.com/post/mexican-food-traditions-an-enduring-heritage" target="_blank" rel="noopener" class="header-link">
          📖 Related Blog Post
        </a>
      </div>
    </header>

    <!-- Step 1 & 2 - Instructions + Flip Cards -->
    <section class="section card">
      <h2><span class="step-indicator">1</span>Read the Testimonials</h2>
      <p class="text-sm">Read each short quote in Spanish. Click "Show English" to reveal the translation when needed.</p>
      
      <h2 style="margin-top: 2rem;"><span class="step-indicator">2</span>Select ONE Research Topic</h2>
      <p class="text-sm">Click any card to flip and reveal your assigned research topic with vetted sources.</p>

      <div class="flip-grid">
        <!-- Coffee Card -->
        <div class="flip-card" tabindex="0" role="button" aria-label="Coffee Veracruz testimonial and research topic">
          <div class="flip-inner">
            <div class="flip-front">
              <span class="flip-badge">☕ Café Veracruz</span>
              <button class="translation-btn" data-trans="cafe">Show English</button>
              
              <div class="quote">
                "El cambio climático está afectando nuestros patrones de cosecha. Las lluvias ya no llegan cuando esperamos, pero seguimos adaptándonos como lo hicieron nuestros abuelos. El café de sombra nos ayuda a proteger la biodiversidad mientras mantenemos viva nuestra tradición."
              </div>
              
              <div class="translation" id="trans-cafe">
                "Climate change is affecting our harvest patterns. The rains no longer arrive when we expect them, but we keep adapting as our elders did. Shade-grown coffee helps protect biodiversity while we keep our tradition alive."
              </div>
              
              <div class="attribution">
                <strong>Attribution:</strong> Coatepec, Veracruz Producer. Source: MDPI <em>Sustainability</em>, 2024 (CC BY 4.0).
              </div>
              
              <div class="flip-hint">Click card to reveal research topic ↻</div>
            </div>
            
            <div class="flip-back">
              <div class="research-topic">
                <h3>🌱 Economic Sustainability</h3>
                <ul>
                  <li>How do these traditions generate income and stability for families or co-ops?</li>
                  <li>What concrete mechanisms (jobs, certifications, fairs) make them viable long-term?</li>
                </ul>
                
                <strong>Research Links (CC/Public)</strong>
                <div class="research-links">
                  <ul>
                    <li><a href="https://www.gob.mx/se/articulos/sabias-que-el-cafe-veracruz-tiene-denominacion-de-origen" target="_blank" rel="noopener">Secretaría de Economía – DO Café Veracruz</a></li>
                    <li><a href="https://www.gob.mx/aserca/articulos/cafe-veracruz?idiom=es" target="_blank" rel="noopener">ASERCA – Café Veracruz</a></li>
                    <li><a href="https://www.mdpi.com/2071-1050/16/2/802" target="_blank" rel="noopener">MDPI Sustainability – Veracruz Coffee</a></li>
                    <li><a href="https://ich.unesco.org/en/decisions/7.COM/9.2" target="_blank" rel="noopener">UNESCO – Totonac Program</a></li>
                  </ul>
                </div>
              </div>
              <div class="flip-hint">Click card to flip back ↻</div>
            </div>
          </div>
        </div>

        <!-- Bread Card -->
        <div class="flip-card" tabindex="0" role="button" aria-label="Pan de Fiesta testimonial and research topic">
          <div class="flip-inner">
            <div class="flip-front">
              <span class="flip-badge">🍞 Pan de Fiesta</span>
              <button class="translation-btn" data-trans="pan">Show English</button>
              
              <div class="quote">
                "Esta tradición tiene 307 años en nuestra comunidad. El pan de fiesta no es solo pan—es nuestra forma de crear redes de reciprocidad. Cuando horneamos para una celebración, fortalecemos los lazos que nos unen como pueblo."
              </div>
              
              <div class="translation" id="trans-pan">
                "This tradition has been in our community for 307 years. Celebration bread is not just bread—it is our way of building reciprocity networks. When we bake for a celebration, we strengthen the bonds that unite us as a people."
              </div>
              
              <div class="attribution">
                <strong>Attribution:</strong> Traditional Baker, San Juan Huactzinco. Source: Congreso del Estado de Tlaxcala / Secretaría de Cultura (public records).
              </div>
              
              <div class="flip-hint">Click card to reveal research topic ↻</div>
            </div>
            
            <div class="flip-back">
              <div class="research-topic">
                <h3>🤝 Indigenous Reciprocity</h3>
                <ul>
                  <li>How does reciprocity appear in work, celebration, or exchange?</li>
                  <li>What responsibilities accompany the benefits within the community?</li>
                </ul>
                
                <strong>Research Links (CC/Public)</strong>
                <div class="research-links">
                  <ul>
                    <li><a href="https://ich.unesco.org/en/RL/traditional-mexican-cuisine-00400" target="_blank" rel="noopener">UNESCO – Traditional Mexican Cuisine</a></li>
                    <li><a href="https://sic.cultura.gob.mx/index.php?table=frpintangible" target="_blank" rel="noopener">Sistema de Información Cultural – Registry</a></li>
                    <li><a href="https://huactzinco.gob.mx/cultura/pan-de-fiesta/" target="_blank" rel="noopener">Municipio de Huactzinco – Pan de Fiesta</a></li>
                    <li><a href="https://www.gob.mx/cultura/" target="_blank" rel="noopener">Secretaría de Cultura – Programs</a></li>
                  </ul>
                </div>
              </div>
              <div class="flip-hint">Click card to flip back ↻</div>
            </div>
          </div>
        </div>

        <!-- Amaranth Card -->
        <div class="flip-card" tabindex="0" role="button" aria-label="Amaranto testimonial and research topic">
          <div class="flip-inner">
            <div class="flip-front">
              <span class="flip-badge">🌾 Amaranto</span>
              <button class="translation-btn" data-trans="amaranto">Show English</button>
              
              <div class="quote">
                "En la época prehispánica, el amaranto conectaba a nuestros ancestros con los dioses. Hoy, las 'alegrías' que producimos conectan el pasado con el presente; son el sustento económico de nuestras familias mientras preservamos 6,000 años de historia."
              </div>
              
              <div class="translation" id="trans-amaranto">
                "In pre-Hispanic times, amaranth connected our ancestors with the gods. Today, the 'alegrías' we make connect past and present, providing income for our families while we preserve 6,000 years of history."
              </div>
              
              <div class="attribution">
                <strong>Attribution:</strong> Artisan, Temoac/Huazulco, Morelos. Source: Sistema de Información Cultural & academic reports.
              </div>
              
              <div class="flip-hint">Click card to reveal research topic ↻</div>
            </div>
            
            <div class="flip-back">
              <div class="research-topic">
                <h3>✊ Cultural Resistance</h3>
                <ul>
                  <li>In what ways do these practices resist homogenization/globalization?</li>
                  <li>Which elements of the tradition are non-negotiable for community identity?</li>
                </ul>
                
                <strong>Research Links (CC/Public)</strong>
                <div class="research-links">
                  <ul>
                    <li><a href="https://ich.unesco.org/en/RL/traditional-mexican-cuisine-00400" target="_blank" rel="noopener">UNESCO – Traditional Mexican Cuisine</a></li>
                    <li><a href="https://mediateca.inah.gob.mx/" target="_blank" rel="noop
